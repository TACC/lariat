#!/usr/bin/env lua
-- -*- lua -*-
require("strict")
require("string_split")
require("VarDump")



DirKeepPass1 = {
   "^/opt/apps/",
   "^/share1/apps",
   "^/work/00515/mclay/apps",
}
   

function inPkg(lib, pkgT)

   for k = 1,#PkgListT do
      local entry = PkgListT[k]
      for kk = 1, #entry.pathA do
         if (lib:find(entry.pathA[kk],1,true)) then
            pkgT[entry.pkg] = entry.flavor
            break
         end
      end
   end
end





local Dbg = require("Dbg")
function main()

   local pkgT     = {}
   local libPathA = {}
   for l in ldd:split("\n") do
      l = l:gsub(".*=> *","")
      l = l:gsub("%(0x.*$","")
      for d = 1, #DirKeepPass1 do
         if (l:find(DirKeepPass1[d]) == 1) then
            libPathA[#libPathA+1] = l
            break;
         end
      end
   end

   

   for i = 1, #libPathA do
      local l = libPathA[i]
      inPkg(l, pkgT)
   end

   for k,v in pairs(pkgT) do
      print ( k, v)
   end
end

main()
